layout(title = paste(FixAxisLabels(xvar), "Vs.", FixAxisLabels(yvar), "Bechdel Financial Analysis"), xaxis = list(range = c(0, xmax), title = FixAxisLabels(xvar)),
yaxis = list(range = c(0, ymax), title = FixAxisLabels(yvar))
) %>%
return()
}
# Fixes capitalization and short-hand names in the data set for display
FixAxisLabels <- function(input.var.name) {
print(input.var.name)
if (input.var.name == 'domgross') { input.var.name <- "Domestic Gross"}
if (input.var.name == "intgross") { input.var.name <- "International Gross"}
return(input.var.name)
}
shiny::runApp()
runApp()
runApp()
library(plotly)
#prepare data for page 3
bechdel_data_raw <- read.csv("./bechdel_data/movies.csv", stringsAsFactors = FALSE)
source('./script/year.R')
year_data <- year(bechdel_data_raw)
source('./script/profitBechdelAssessment.R')
shinyUI(shinyUI(navbarPage("Bechdel Test",
tabPanel("ADELE", titlePanel('Adjust Rating (PG-13, etc.) Affect Passing Rates?')),
tabPanel("ADELE", titlePanel('Does Profit or Budget Affect Passing Rates?'),
sidebarLayout(
# Side panel for controls
sidebarPanel(
# Input to select variable to map
selectInput('scatterVarX', label = 'Variable to Map to X Axis', choices = list('Budget' = 'budget', 'Domestic Gross' = 'domgross', 'International Gross' = 'intgross')),
selectInput('scatterVarY', label = 'Variable to Map to Y Axis', choices = list('Budget' = 'budget', 'Domestic Gross' = 'domgross', 'International Gross' = 'intgross'))
),
# Main panel: display plotly map
mainPanel(
plotlyOutput('profitBechdelAssessment'))
)
),
tabPanel("SHERRI", titlePanel('Does Budget Affect Passing Rates?')),
#tab page 3 by Anni
tabPanel("ANNI", titlePanel('Does Year Made Affect Passing Rates?'),
#page 3 side bar lay out
sidebarLayout(
#page 3 side bar panel
sidebarPanel(
#page 3 check box widget
sliderInput("slider1", label = h3("Slider"), min = year_data$year[44],
max = year_data$year[1], value = c(year_data$year[40], year_data$year[30]))
),
#page 3 main panel
mainPanel(
plotlyOutput('boxgraph')
)
)
)
)
#tabPanel("KEANAN", titlePanel('Does Genre Made Affect Passing Rates?'))
#YOU SHOULD MODIFY THIS FILE BY ADDING YOUR OUTPUT AFTER THE PAGE NAME LIKE THIS:
#tabPanel("Page 1", plotOutput("pg1")) <--I think.....? #
))
movie.data <- read.csv("./bechdel_data/movies.csv", stringsAsFactors =  FALSE)
View(movie.data)
source('./script/year.R')
modified_data <- year(movie.data)
View(modified_data)
modified_data <- modified_data %>%
filter(year >= input$slider[1] & year <= input$slider[2])
runApp()
runApp()
runApp()
library(httr)
library(jsonlite)
library(dplyr)
#find information about each movie by given id number
#example <- "http://www.omdbapi.com/?i=tt3896198&apikey=c53bd0e4"
find_movie <- function(id) {
base.uri <- "http://www.omdbapi.com/?"
query.param <- list(i = id, apikey='23e78b2d')
response <- GET(base.uri, query = query.param)
body <- content(response, "text")
result <- as.data.frame(fromJSON(body))
data <- result[1, ]
#data <- data %>% select(Title, Year, Rated, Genre, Director, Writer, Actors, Plot, Language,
# Country, Awards, Ratings.Source, imdbRating, imdbVotes, imdbID, Production)
return (data)
}
find_movie("tt1711425")
library(httr)
library(jsonlite)
library(dplyr)
#find information about each movie by given id number
#example <- "http://www.omdbapi.com/?i=tt3896198&apikey=c53bd0e4"
find_movie <- function(id) {
base.uri <- "http://www.omdbapi.com/?"
query.param <- list(i = id)
response <- GET(base.uri, query = query.param)
body <- content(response, "text")
result <- as.data.frame(fromJSON(body))
data <- result[1, ]
#data <- data %>% select(Title, Year, Rated, Genre, Director, Writer, Actors, Plot, Language,
# Country, Awards, Ratings.Source, imdbRating, imdbVotes, imdbID, Production)
return (data)
}
find_movie("tt1711425")
runApp()
runApp()
runApp()
>>>>>>> b5f96e23ba3bee300bc460098a73bec91791ef52
joined.movie.data <- read.csv("./bechdel_data/final_joined_bechdel_data.csv", stringsAsFactors = FALSE)
shiny::runApp()
View(joined.movie.data)
runApp()
runApp()
runApp()
g <- ggplot(joined.movie.data, aes(clean_test, binary)) +
geom_label(aes(label = clean_test))
g
group_failed_test <- joined.movie.data %>%
group_by(clean_test) %>%
summarise(test_result = clean_test, num = n())
group_failed_test <- joined.movie.data %>%
group_by(clean_test) %>%
summarise(num = n())
View(group_failed_test)
group_failed_test <- joined.movie.data %>%
group_by(clean_test) %>%
summarise(num = n(), result = binary)
group_failed_test <- movie.data %>%
group_by(clean_test) %>%
summarise(num = n(), result = binary)
group_failed_test <- movie.data %>%
group_by(clean_test) %>%
summarise(num = n())
movie.data <- read.csv("./bechdel_data/movies.csv", stringsAsFactors =  FALSE)
group_failed_test <- movie.data %>%
group_by(clean_test) %>%
summarise(num = n())
View(movie.data)
g <- ggplot(movie.data) +
geom_point() +
facet_grid(budget~year)
ggplot(movie.data) +
geom_point() +
facet_grid(budget~year)
ggplot(movie.data, aes(budget, year)) +
geom_point() +
facet_grid(budget~year)
ggplot(movie.data, aes(budget, year)) +
geom_point() +
facet_grid(clean_test)
colnames(movie.data)
runApp()
ggplot(movie.data, aes(budget, year)) +
geom_point() +
facet_grid(clean_test~.)
ggplot(movie.data, aes(budget, year)) +
geom_point() +
facet_grid(clean_test~binary)
ggplot(movie.data, aes(year, budget)) +
geom_point() +
facet_grid(clean_test~binary)
ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point() +
facet_grid(clean_test~binary)
ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point() +
facet_grid(clean_test~binary) +
scale_fill_brewer(palette = "Blues")
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score)) +
facet_grid(clean_test~binary)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score), color = imdb_score) +
facet_grid(clean_test~binary)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = imdb_score)) +
facet_grid(clean_test~binary)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary)) +
facet_grid(clean_test~.)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary), alpha = 0.5) +
facet_grid(clean_test~.)
joined.movie.data$budget.x
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary, size = budget.x), alpha = 0.5) +
facet_grid(clean_test~.)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary, size = budget.x), alpha = 0.1) +
facet_grid(clean_test~.)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary, size = budget.x), alpha = 0.2) +
facet_grid(clean_test~.)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary, size = country), alpha = 0.2) +
facet_grid(clean_test~.)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = country, size = binary), alpha = 0.2) +
facet_grid(clean_test~.)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = content_rating, size = binary), alpha = 0.2) +
facet_grid(clean_test~.)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary), alpha = 0.2) +
facet_grid(clean_test~.)
ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary, text = title), alpha = 0.2) +
labs(title = "Test Results of movies from 1970 - 2013") +
facet_grid(clean_test~.)
g <- ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary), alpha = 0.5) +
labs(title = "Test Results of movies from 1970 - 2013") +
facet_grid(clean_test~.)
g <- ggplotly(g)
g <- ggplotly(g)
g
g <- ggplot(joined.movie.data) +
geom_point(mapping = aes(year, imdb_score, color = binary), alpha = 0.5, text = title) +
labs(title = "Test Results of movies from 1970 - 2013") +
facet_grid(clean_test~.)
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary, text = "hi"), alpha = 0.5) +
labs(title = "Test Results of movies from 1970 - 2013") +
facet_grid(clean_test~.)
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary, text = name), alpha = 0.5, name = "title") +
labs(title = "Test Results of movies from 1970 - 2013") +
facet_grid(clean_test~.)
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary, text = name), alpha = 0.5, name = title) +
labs(title = "Test Results of movies from 1970 - 2013") +
facet_grid(clean_test~.)
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary, label = title), alpha = 0.5) +
labs(title = "Test Results of movies from 1970 - 2013") +
facet_grid(clean_test~.)
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary), alpha = 0.5) +
labs(title = "Test Results of movies from 1970 - 2013") +
facet_grid(clean_test~.)
g <- ggplotly(g) %>%
layout(titile = "Test Results of movies from 1970 - 2013",
xaxis = list(title = title),
yaxis = list(title = context.rating))
g <- ggplotly(g) %>%
layout(titile = "Test Results of movies from 1970 - 2013",
xaxis = list(title = title),
yaxis = list(title = context_rating))
g <- ggplotly(g) %>%
layout(titile = "Test Results of movies from 1970 - 2013",
xaxis = list(title = title),
yaxis = list(title = content_rating))
g <- ggplotly(g) %>%
layout(titile = "Test Results of movies from 1970 - 2013",
xaxis = list(title = title),
yaxis = list()
)
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary), alpha = 0.5) +
facet_grid(clean_test~.)
ggplotly(g) %>%
layout(titile = "Test Results of movies from 1970 - 2013",
xaxis = list(title = title),
yaxis = list()
)
ggplotly(g) %>%
layout(titile = "Test Results of movies from 1970 - 2013",
xaxis = list(title = title),
yaxis = list()
)
devtools::install_github('hadley/ggplot2')
devtools::install_github('hadley/ggplot2')
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary), alpha = 0.5) +
facet_grid(clean_test~.)
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary), alpha = 0.5) +
geom_smooth(aes(color = binary))
facet_grid(clean_test~.)
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary), alpha = 0.5) +
geom_smooth(aes(color = binary)) +
facet_grid(clean_test~.)
g
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = binary), alpha = 0.5) +
facet_grid(clean_test~.)
g
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(clean_test~.)
g
group_failed_test <- joined.movie.data %>%
filter(clean_test != "ok")
group_by(clean_test) %>%
summarise(num = n())
g <- ggplot(joined.movie.data, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(clean_test~.)
g
View(group_failed_test)
group_failed_test <- joined.movie.data %>%
filter(clean_test != "ok")
group_by(clean_test) %>%
summarise(num = n())
group_failed_test <- joined.movie.data %>%
filter(clean_test != "ok")
g <- ggplot(group_failed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(clean_test~.)
g
ggplot(group_failed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating, size = budget.x), alpha = 0.5) +
facet_grid(clean_test~.)
g <- ggplot(group_failed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(clean_test~.)
group_passed_test <- joined.movie.data %>%
filter(clean_test == "ok")
g2 <- ggplot(group_passed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(clean_test~.)
ggplotly(g2)
g2 <- ggplot(group_passed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5)
ggplotly(g2)
ggplot(group_passed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating, text = title), alpha = 0.5)
ggplotly(g)
g <- ggplot(group_failed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(clean_test~.)
ggplotly(g)
g <- ggplot(group_failed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(.~clean_test)
ggplotly(g)
g <- ggplot(group_failed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(clean_test~.)
ggplotly(g)
runApp()
runApp()
runApp()
group_failed_test <- joined.movie.data %>%
filter(binary == "PASS")
g <- ggplot(group_failed_test, aes(year, imdb_score)) +
geom_point(aes(color = content_rating), alpha = 0.5) +
facet_grid(clean_test~.)
ggplotly(g)
runApp()
runApp()
modified_data <- year(movie.data)
View(modified_data)
modified_data <- year(movie.data)
modified_data <- year(movie.data)
View(modified_data)
test <- yearly_data(2013)
View(test)
yearly_data <- function(input.year) {
pass_or_fail <- yearly_dataset %>%
filter(year == input.year) %>%
summarise(year = input.year, FAIL = sum(binary == "FAIL"), PASS = sum(binary == "PASS"),
total = length(binary))
return(pass_or_fail)
}
test <- yearly_data(2013)
View(test)
modified_data <- year(movie.data)
View(modified_data)
runApp()
modified_data[, "PASS"]
runApp()
test <- year(bechdel_data_raw)
View(test)
modified_data <- year(movie.data)
modified_data <- modified_data %>%
filter(year >= input$slider[1] & year <= input$slider[2]) %>%
mutate(pass_ratio = PASS / total)
p <- plot_ly(x = modified_data$year, y = (modified_data[, input$button] / modified_data$total),
type = "scatter", mode = "lines", color = modified_data$pass_ratio,
name = input$button) %>%
layout(title = paste(input$button,"rate from 1970 to 2013"))
return(p)
runApp()
shiny::runApp()
runApp()
View(joined.movie.data)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
install.packages('shinythemes')
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp('C:/Users/thinkpad/Desktop/Info201GroupProj')
runApp('C:/Users/thinkpad/Desktop/Info201GroupProj')
tags$h3("Bechdel Test Report")
runApp('C:/Users/thinkpad/Desktop/Info201GroupProj')
runApp()
runApp('C:/Users/thinkpad/Desktop/Info201GroupProj')
runApp('C:/Users/thinkpad/Desktop/Info201GroupProj')
runApp('C:/Users/thinkpad/Desktop/Info201GroupProj')
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
??tags$button
runApp()
runApp()
View(joined.movie.data)
movie_title <- joined.movie.data %>%
select(title)
View(movie_title)
View(joined.movie.data)
grepl("hi", "hii")
grepl("hii", "h")
runApp()
runApp()
runApp()
runApp()
movie_title <- joined.movie.data %>%
select(contains("a")) %>%
select(title, imdb, year, clean_test, binary,
director_name, duration, budget.x, genre, plot_keywords,
movie_imdb_link, language, country, imdb_score)
movie_title <- joined.movie.data %>%
filter(contains("a"))
title <- grep("a", joined.movie.data$title)
data <- movie_title[title, ]
movie_title <- joined.movie.data %>%
filter(title = data)
movie_title <- joined.movie.data %>%
filter(title == data)
View(movie_title)
data
movie_title <- joined.movie.data %>%
filter(title == data)
data <- movie_title[grep("a", joined.movie.data$title), ]
data
View(data)
movie_title <- joined.movie.data %>%
filter(title == grep("a", joined.movie.data$title))
View(movie_title)
movie_title <- joined.movie.data %>%
filter(title == grep("a", joined.movie.data$title))
grep("a", joined.movie.data)
joined.movie.data[grep("a", joined.movie.data), ]
data <- joined.movie.data[grep("a", joined.movie.data), ]
View(data)
movie_title <- data %>%
select(title, imdb, year, clean_test, binary,
director_name, duration, budget.x, genre, plot_keywords,
movie_imdb_link, language, country, imdb_score)
View(movie_title)
movie_title <- data %>%
select(title, imdb, year, clean_test, binary,
director_name, duration, budget.x, genres, plot_keywords,
movie_imdb_link, language, country, imdb_score)
View(movie_title)
if (nrow(movie_title != 0)){
return(kable(movie_title))
} else {
return("Sorry, couldn't find the movie")
}
runApp()
shiny::runApp()
shiny::runApp()
runApp()
